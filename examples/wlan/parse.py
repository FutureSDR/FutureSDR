#!/usr/bin/env python3

import socket
from scapy.layers.dot11 import *
from scapy.packet import Packet
from scapy.all import *

UDP_IP = "127.0.0.1"
UDP_PORT = 55555

sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
sock.bind((UDP_IP, UDP_PORT))

while True:
    data, addr = sock.recvfrom(1024 * 2)
    dot11_packet = Dot11(data)
    print(dot11_packet.summary())


# frame = [128, 0, 0, 0, 255, 255, 255, 255, 255, 255, 68, 78, 109, 94, 65, 84, 68, 78, 109, 94, 65, 84, 176, 20, 57, 240, 105, 244, 208, 8, 0, 0, 100, 0, 17, 21, 0, 17, 70, 82, 73, 84, 90, 33, 66, 111, 120, 32, 55, 53, 51, 48, 32, 79, 84, 1, 8, 140, 18, 152, 36, 176, 72, 96, 108, 3, 1, 36, 5, 4, 0, 1, 0, 0, 7, 60, 68, 69, 32, 36, 1, 23, 40, 1, 23, 44, 1, 23, 48, 1, 23, 52, 1, 23, 56, 1, 23, 60, 1, 23, 64, 1, 23, 100, 1, 30, 104, 1, 30, 108, 1, 30, 112, 1, 30, 116, 1, 30, 120, 1, 30, 124, 1, 30, 128, 1, 30, 132, 1, 30, 136, 1, 30, 140, 1, 30, 11, 5, 2, 0, 1, 0, 0, 70, 5, 115, 208, 0, 0, 12, 45, 26, 239, 9, 3, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 61, 22, 36, 5, 4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 74, 14, 20, 0, 10, 0, 44, 1, 200, 0, 20, 0, 5, 0, 25, 0, 127, 8, 5, 0, 15, 0, 0, 0, 0, 64, 191, 12, 178, 89, 137, 51, 250, 255, 0, 0, 250, 255, 0, 32, 192, 5, 1, 42, 0, 252, 255, 193, 6, 2, 0, 0, 115, 0, 0, 195, 4, 2, 46, 46, 46, 221, 24, 0, 80, 242, 2, 1, 1, 0, 0, 3, 164, 0, 0, 39, 164, 0, 0, 66, 67, 94, 0, 98, 50, 47, 0, 221, 9, 0, 3, 127, 1, 1, 0, 0, 255, 127, 221, 8, 140, 253, 240, 1, 1, 2, 1, 0, 221, 22, 140, 253, 240, 4, 0, 0, 73, 76, 81, 3, 2, 9, 114, 1, 0, 0, 0, 0, 239, 18, 0, 0, 221, 12, 0, 4, 14, 1, 1, 2, 1, 0, 0, 0, 0, 0, 221, 29, 0, 80, 242, 4, 16, 74, 0, 1, 16, 16, 68, 0, 1, 2, 16, 60, 0, 1, 3, 16, 73, 0, 6, 0, 55, 42, 0, 1, 32, 48, 20, 1, 0, 0, 15, 172, 4, 1, 0, 0, 15, 172, 4, 1, 0, 0, 15, 172, 2, 0, 0]

# dot11_packet = Dot11(bytes(frame))
# print(dot11_packet.mysummary)
